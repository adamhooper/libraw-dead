<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>LibRaw: компиляция и установка</title>
  <meta http-equiv="content-type" content="text/html; charset=windows-1251">
  </head>

  <body>
    <a href=index-rus.html>[вернуться к оглавлению]</a>
    <h1>LibRaw: компиляция и установка</h1>
    <p>LibRaw поставляется в исходных текстах, для использования необходимо их скомпилировать (и, при желании,
      установить в системные каталоги с библиотеками и include-файлами)</p>
    <a name="unix"></a>
    <h2>Unix-системы (FreeBSD, Linux, Mac OS X)</h2>
    <p>
      Для сборки библиотеки вам нужен работающий компилятор C++ (gcc версий 3.x или 4.x вполне подойдет, сборка
      другими компиляторами не тестировалась) и программа make. Никаких других библиотек, утилит и т.п. - не
      требуется.</p>
    <p>
      LibRaw тестировалась на 32-битных и 64-битных Unix-системах на x86- (и AMD64-) совместимых процессорах. Сборка
      и работоспособность на каких-либо еще архитектурах не тестировалась.
    </p>
    <h3>Компиляция библиотеки и примеров</h3>
    <p>
      Распакуйте скачанный дистрибутив, перейдите в получшвшийся каталог и запустите make:
    </p>
    <pre>
        tar xzvf LibRaw-X.YY.tar.gz
        cd  LibRaw-X.YY
        make
    </pre>
    <p>В результате скомпилируются:</p>
    <ul>
      <li>Библиотеку libraw.a в каталоге lib/</li>
      <li><a href=Samples-LibRaw-rus.html>Примеры</a> в каталоге bin/ (исходные тексты примеров находятся в каталоге
        samples).</li>
    </ul>
    <p>В текущей версии собираются только статические библиотеки:</p>
    <ul>
      <li>libraw.a - не thread_safe вариант</li>
      <li>libraw_r.a - thread safe</li>
    </ul>
    <h3>Сборка с lcms</h3>
    <p>
      Для сборки с поддержкой ICC-профилей необходимо раскомментировать в Makefile две строчки, следующие после строки
<pre>
# LCMS support
</pre>
    Предполагается, что библиотека lcms установлена в /usr/local/lib или /usr/lib, а lcms.h - в /usr/local/include или
    /usr/include. Если на вашей системе это не так, то придется подправить пути в LCMS_DEF и LCMS_LIB в Makefile
    </p>
    <h3>Поддержка OpenMP</h3>
    <p>Для сборки с автоматическим распараллеливанием ряда ресурсоемких стадий обработки необходимо раскомментировать
      в Makefile одну строчку, следующую после строки
<pre>
# OpenMP support
</pre>

    <h3>Установка и использование</h3>
    <p> Для установки библиотеки выполните команду</p>
    <pre>
make install
    </pre>
    <p>
    Она установит библиотеки в <b>/usr/local/lib</b>, а include-файлы в /usr/local/include (в подкаталог libraw).
    <br/>
      Для использования LibRaw добавьте следующие параметры к вызову компилятора (при сборке собственных проектов):
    </p>
    <ul>
      <li>Путь к Include-файлам: -I/usr/local/include</li>
      <li>Путь к библиотекам: -L/usr/local/lib</li>
      <li>Библиотека: -lraw (обычная версия) или -lraw_r (thread-safe версия)</li>
    </ul>
    <h4>Установка примеров</h4>
    <p>
      Для установки примеров выполните команду <b>make install-binaries</b>, которая скопирует все скомпилированные
      примеры в <b>/usr/local/bin</b>
    </p>
    <h2>Windows, сборка под Cygwin</h2>
    <p>
      Сборка и установка полностью аналогична <a href="#unix">сборке и установке на unix-системах</a>.
    </p>
    <h2>Windows, native-сборка</h2> 
    <p>
      Сборка под Windows делается в три шага:
    </p>
    <ul>
      <li>Распакуйте дистрибутив (если у вас нет tar+gzip, возьмите дистрибутив LibRaw в формате .ZIP), перейдите в
        каталог LibRaw-X.YYY
      </li>
      <li>Нужно установить переменные окружения так, чтобы компилятор/линковщик находил библиотеки и
        include-файлы. Для Visual C++ это делается запуском <b>vcvars32.bat</b>.
      </li>
      <li>
        Запускается<br/>
        <b>nmake -f Makefile.msvc</b><br/>
      </li>
    </ul>
    <p>
    Если все пути установлены правильно и include-файлы/библиотеки нашлись, то скомпилируются:</p>
    <ul>
      <li>Библиотека libraw_static.lib в каталоге lib</li>
      <li>Динамическая библиотека bin/libraw.dll и линковочная библиотека к ней lib/libraw.lib</li>
      <li>Примеры в каталоге bin</li>
    </ul>
    <p> Под Win32 собирается только thread-safe библиотека, ее можно использовать и не с
      multi-threaded-приложениями. Все примеры собираются с динамической библиотекой (DLL),
      при необходимости использовать статическую сборку, нужно линковаться с библиотекой libraw_static.lib а при
      компиляции указывать директиву препроцессора /DLIBRAW_NODLL.
    </p>
    <p>
      Windows-версия в настоящее время собирается без поддержки библиотеки LCMS (ICC-профилей).
    </p>
    <p>
      При сборке DLL экспортируются все публичные функции, в дальнейшем экспортируемое подмножество может быть
      уменьшено. 
    </p>
    <p>
      К сожалению, пути к include/библиотекам зависят от способа, которым у вас установлен Visual C (или другой
      компилятор), поэтому вписать какие-то стандартные пути в Makefile.msvc невозможно.
    </p>
    <h2>Windows,  установка</h2> 
    <p>
      Какая-либо установка под Windows не поддерживается, предполагается что все .DLL будут поставляться вместе с
      использующей их программой (которая и сделает установку). Соответственно, при сборке программ, использующих
      LibRaw путь до библиотек, DLL и include-файлов должен задаваться вручную.
    </p>
    <a href=index-rus.html>[вернуться к оглавлению]</a>
    <hr>
    <address><a href="mailto:info@libraw.org">LibRaw Team</a></address>
<!-- Created: Sun Mar 16 11:53:43 MSK 2008 -->
<!-- hhmts start -->
Last modified: Sun Mar 28 22:08:21 MSD 2010
<!-- hhmts end -->
  </body>
</html>
